<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="feb07f20-8170-4fe0-87f9-d55fc4349857" Name="HiveRobotLogger" Language="1033" Version="1.0.0.0" Manufacturer="BioNex Solutions Inc." UpgradeCode="290d37e0-2e8a-407b-bf45-66f4b0292e7d">
		<Package InstallerVersion="200" Compressed="yes" />

		<Media Id="1" Cabinet="media1.cab" EmbedCab="yes" />

		<Directory Id="TARGETDIR" Name="SourceDir">
      <!-- this creates the application folder for the exe underneath c:\Program Files -->
      <Directory Id="ProgramFilesFolder">
        <Directory Id="CompanyFolder" Name="BioNex">
          <Directory Id="INSTALLLOCATION" Name="HiveRobotLogger">
          </Directory>
        </Directory>
      </Directory>
      <!-- this directory is defined for the application shortcut on the desktop -->
      <Directory Id="DesktopFolder" Name="Desktop" />
    </Directory>

    <DirectoryRef Id="INSTALLLOCATION">
      <Component Id="EXECUTABLE_COMPONENT" Guid="0FA816D3-3119-4537-BBEA-9C25D5B37392" >
        <File Id="EXECUTABLE_FILE" Source="$(var.ProjectDir)..\HiveRobotLogger\$(var.OutDir)HiveRobotLogger.exe" KeyPath="yes"/>
      </Component>
      <Component Id="UCANDOTNET_COMPONENT" Guid="016C3D5A-3769-4FFE-A290-F6B96E324953">
        <File Id="UCANDOTNET_FILE" Source="$(var.ProjectDir)..\HiveRobotLogger\$(var.OutDir)UcanDotNET.dll" KeyPath="yes" />
      </Component>
    </DirectoryRef>

    <Feature Id="ProductFeature" Title="HiveRobotLogger" Level="1">
      <ComponentRef Id="EXECUTABLE_COMPONENT" />
      <ComponentRef Id="UCANDOTNET_COMPONENT"/>
      <ComponentRef Id="DESKTOP_SHORTCUT_1_COMPONENT"/>
      <ComponentRef Id="DESKTOP_SHORTCUT_2_COMPONENT"/>
      <!-- Note: The following ComponentGroupRef is required to pull in generated authoring from project references. -->
			<!--<ComponentGroupRef Id="Product.Generated" /> -->
		</Feature>


    <!-- create shortcuts in start menu-->
<!--    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ProductShortcut" Guid="FC06674E-C8EF-4bc6-9AC7-FAE4137147C5">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="Synapsis"
                  Description="Automation software package for BioNex Bumblebee + Hive"
                  Target="[INSTALLLOCATION]SynapsisPrototype.exe"
                  WorkingDirectory="INSTALLLOCATION" />
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall" />
        <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
    </DirectoryRef>-->

    <!-- create shortcut on desktop-->
    <DirectoryRef Id="DesktopFolder">
      <Component Id="DESKTOP_SHORTCUT_1_COMPONENT" Guid="DF57BF17-C851-48D4-B46F-D533D668CD52">
        <Shortcut Id="DESKTOP_SHORTCUT_1"
                  Name="Record Channel 1 Z Axis"
                  Description="Record Channel 1 Z Axis"
                  Target="[INSTALLLOCATION]HiveRobotLogger.exe"
                  Arguments="-id 13 -test_cycles 1000"
                  WorkingDirectory="INSTALLLOCATION" />
        <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
      <Component Id="DESKTOP_SHORTCUT_2_COMPONENT" Guid="5D13C5E6-A036-4EC6-8A1C-997E91E962AC">
        <Shortcut Id="DESKTOP_SHORTCUT_2"
                  Name="Record Channel 2 Z Axis"
                  Description="Shortcut to record diagnostics for Channel 2 Z Axis"
                  Target="[INSTALLLOCATION]HiveRobotLogger.exe"
                  Arguments="-id 23 -test_cycles 1000"
                  WorkingDirectory="INSTALLLOCATION" />
        <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
    </DirectoryRef>
  </Product>
</Wix>
