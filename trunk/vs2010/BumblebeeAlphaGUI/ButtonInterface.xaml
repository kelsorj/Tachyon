<UserControl x:Class="BioNex.BumblebeeAlphaGUI.ButtonInterface"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:my="clr-namespace:BioNex.BumblebeeAlphaGUI"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    xmlns:utils="clr-namespace:BioNex.Shared.Utils;assembly=Utils">
    <UserControl.Resources>
        <x:Array x:Key="Increments" Type="sys:Double">
            <sys:Double>0.01</sys:Double>
            <sys:Double>0.025</sys:Double>
            <sys:Double>0.05</sys:Double>
            <sys:Double>0.1</sys:Double>
            <sys:Double>0.25</sys:Double>
            <sys:Double>0.5</sys:Double>
            <sys:Double>1.0</sys:Double>
            <sys:Double>2.0</sys:Double>
            <sys:Double>5.0</sys:Double>
            <sys:Double>10.0</sys:Double>
            <sys:Double>20.0</sys:Double>
            <sys:Double>50.0</sys:Double>
            <sys:Double>100.0</sys:Double>
            <sys:Double>200.0</sys:Double>
            <sys:Double>500.0</sys:Double>
        </x:Array>
        <x:Array x:Key="ThetaIncrements" Type="sys:Double">
            <sys:Double>0.01</sys:Double>
            <sys:Double>0.02</sys:Double>
            <sys:Double>0.05</sys:Double>
            <sys:Double>0.1</sys:Double>
            <sys:Double>0.2</sys:Double>
            <sys:Double>0.5</sys:Double>
            <sys:Double>1.0</sys:Double>
            <sys:Double>2.0</sys:Double>
            <sys:Double>5.0</sys:Double>
            <sys:Double>10.0</sys:Double>
            <sys:Double>15.0</sys:Double>
            <sys:Double>30.0</sys:Double>
            <sys:Double>45.0</sys:Double>
            <sys:Double>60.0</sys:Double>
            <sys:Double>90.0</sys:Double>
            <sys:Double>180.0</sys:Double>
        </x:Array>
        <utils:StringFormatter x:Key="PositionFormatConverter" />
        <ControlTemplate x:Key="ULPopupTemplate">
            <Border Background="White" BorderBrush="Black" Padding="5" BorderThickness="2" CornerRadius="5">
                <StackPanel Orientation="Vertical">
                    <Button Command="{Binding MoveAboveULCommand}" CommandParameter="5">5mm</Button>
                    <Button Command="{Binding MoveAboveULCommand}" CommandParameter="10">10mm</Button>
                    <Button Command="{Binding MoveAboveULCommand}" CommandParameter="15">15mm</Button>
                    <Button Command="{Binding MoveAboveULCommand}" CommandParameter="20">20mm</Button>
                </StackPanel>
            </Border>
        </ControlTemplate>
        <ControlTemplate x:Key="LRPopupTemplate">
            <Border Background="White" BorderBrush="Black" Padding="5" BorderThickness="2" CornerRadius="5">
                <StackPanel Orientation="Vertical">
                    <Button Command="{Binding MoveAboveLRCommand}" CommandParameter="5">5mm</Button>
                    <Button Command="{Binding MoveAboveLRCommand}" CommandParameter="10">10mm</Button>
                    <Button Command="{Binding MoveAboveLRCommand}" CommandParameter="15">15mm</Button>
                    <Button Command="{Binding MoveAboveLRCommand}" CommandParameter="20">20mm</Button>
                </StackPanel>
            </Border>
        </ControlTemplate>
        <ControlTemplate x:Key="ULPopupControlTemplate" TargetType="ContentControl">
            <Grid Name="MyControl">
                <ContentPresenter Content="{TemplateBinding Content}"/>
                <Popup Name="MyPopup" StaysOpen="True" Placement="Bottom">
                    <ContentControl Template="{StaticResource ULPopupTemplate}"/>
                </Popup>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger SourceName="MyControl" Property="UIElement.IsMouseOver" Value="True">
                    <Setter TargetName="MyPopup" Property="Popup.IsOpen" Value="True"/>
                </Trigger>
                <!--
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition SourceName="MyControl" Property="UIElement.IsMouseOver" Value="False" />
                        <Condition SourceName="MyPopup" Property="UIElement.IsMouseOver" Value="False" />
                    </MultiTrigger.Conditions>
                    <Setter TargetName="MyPopup" Property="Popup.IsOpen" Value="False" />
                </MultiTrigger>
                -->
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <ControlTemplate x:Key="LRPopupControlTemplate" TargetType="ContentControl">
            <Grid Name="MyControl">
                <ContentPresenter Content="{TemplateBinding Content}"/>
                <Popup Name="MyPopup" StaysOpen="True" Placement="Bottom">
                    <ContentControl Template="{StaticResource LRPopupTemplate}"/>
                </Popup>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger SourceName="MyControl" Property="UIElement.IsMouseOver" Value="True">
                    <Setter TargetName="MyPopup" Property="Popup.IsOpen" Value="True"/>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition MinHeight="380"></RowDefinition>
            <!-- robot teaching -->
            <RowDefinition Height="50"></RowDefinition>
            <!-- tipbox teaching -->
            <RowDefinition Height="75"></RowDefinition>
            <!-- position readout -->
            <RowDefinition Height="25"></RowDefinition>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition></ColumnDefinition>
            <ColumnDefinition></ColumnDefinition>
            <ColumnDefinition Width="150"></ColumnDefinition>
        </Grid.ColumnDefinitions>
        <!-- Channel side -->
        <Grid Margin="3">
            <Grid.RowDefinitions>
                <RowDefinition Height="25"></RowDefinition>
                <RowDefinition></RowDefinition>
            </Grid.RowDefinitions>
            <Label Grid.Row="0" HorizontalContentAlignment="Center" Background="Gray">Channel</Label>
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="70"></ColumnDefinition>
                    <ColumnDefinition></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                    </Grid.RowDefinitions>
                    <Border CornerRadius="5" Padding="3" Grid.Row="0" BorderThickness="1" BorderBrush="DarkGray">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="25"></RowDefinition>
                                <RowDefinition></RowDefinition>
                                <RowDefinition Height="25"></RowDefinition>
                                <RowDefinition></RowDefinition>
                            </Grid.RowDefinitions>
                            <Label Grid.Row="0" HorizontalAlignment="Center">W</Label>
                            <Button Command="{Binding JogWUpCommand}" Grid.Row="1">Jog Up</Button>
                            <ComboBox ItemsSource="{StaticResource Increments}" Text="{Binding WIncrement, Mode=TwoWay}" Grid.Row="2" Margin="3"></ComboBox>
                            <Button Command="{Binding JogWDownCommand}" Grid.Row="3">Jog Down</Button>
                        </Grid>
                    </Border>
                    <Border CornerRadius="5" Padding="3" Grid.Row="1" BorderThickness="1" BorderBrush="DarkGray">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="25"></RowDefinition>
                                <RowDefinition></RowDefinition>
                                <RowDefinition Height="25"></RowDefinition>
                                <RowDefinition></RowDefinition>
                            </Grid.RowDefinitions>
                            <Label Grid.Row="0" HorizontalAlignment="Center">Z</Label>
                            <Button Command="{Binding JogZUpCommand}" Grid.Row="1">Jog Up</Button>
                            <ComboBox ItemsSource="{StaticResource Increments}" Text="{Binding ZIncrement, Mode=TwoWay}" Grid.Row="2" Margin="3"></ComboBox>
                            <Button Command="{Binding JogZDownCommand}" Grid.Row="3">Jog Down</Button>
                        </Grid>
                    </Border>
                </Grid>
                <Border  Grid.Column="1" VerticalAlignment="Center" CornerRadius="5" Padding="3" Grid.Row="1" BorderThickness="1" BorderBrush="DarkGray">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition></ColumnDefinition>
                            <ColumnDefinition></ColumnDefinition>
                            <ColumnDefinition></ColumnDefinition>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Row="0" HorizontalAlignment="Center" Grid.ColumnSpan="3">X</Label>
                        <Button Command="{Binding JogXLeftCommand}" Grid.Row="1" Grid.Column="0">Jog Left</Button>
                        <ComboBox ItemsSource="{StaticResource Increments}" Text="{Binding XIncrement, Mode=TwoWay}" Grid.Row="1" Grid.Column="1" Margin="3"></ComboBox>
                        <Button Command="{Binding JogXRightCommand}" Grid.Row="1" Grid.Column="2">Jog Right</Button>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
        <!-- Stage side -->
        <Grid Grid.Column="1" Margin="3">
            <Grid.RowDefinitions>
                <RowDefinition Height="25"></RowDefinition>
                <RowDefinition></RowDefinition>
            </Grid.RowDefinitions>
            <Label Grid.Row="0" HorizontalContentAlignment="Center" Background="Gray">Stage</Label>
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition></ColumnDefinition>
                    <ColumnDefinition Width="75"></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <Border VerticalAlignment="Center" CornerRadius="5" Padding="3" BorderThickness="1" BorderBrush="DarkGray">
                    <Grid VerticalAlignment="Center">
                        <Grid.RowDefinitions>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition></ColumnDefinition>
                            <ColumnDefinition></ColumnDefinition>
                            <ColumnDefinition></ColumnDefinition>
                        </Grid.ColumnDefinitions>
                        <Label Grid.Row="0" HorizontalAlignment="Center" Grid.ColumnSpan="3">Theta</Label>
                        <Button Command="{Binding JogRCCWCommand}" Grid.Row="1" Grid.Column="0">Jog CCW</Button>
                        <ComboBox ItemsSource="{StaticResource ThetaIncrements}" Text="{Binding RIncrement, Mode=TwoWay}" Grid.Row="1" Grid.Column="1" Margin="3"></ComboBox>
                        <Button Command="{Binding JogRCWCommand}" Grid.Row="1" Grid.Column="2">Jog CW</Button>
                    </Grid>
                </Border>
                <Grid Grid.Column="1">
                    <Grid Grid.Row="0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="25"></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition Height="25"></RowDefinition>
                            <RowDefinition></RowDefinition>
                        </Grid.RowDefinitions>
                        <Label Grid.Row="0" HorizontalAlignment="Center">Y</Label>
                        <Button Command="{Binding JogYAwayCommand}" Grid.Row="1">Jog Away</Button>
                        <ComboBox ItemsSource="{StaticResource Increments}" Text="{Binding YIncrement, Mode=TwoWay}" Grid.Row="2" Margin="3"></ComboBox>
                        <Button Command="{Binding JogYTowardsCommand}" Grid.Row="3">Jog Towards</Button>
                    </Grid>
                </Grid>
            </Grid>
        </Grid>
        <Grid Grid.Column="2" Background="LightGray">
            <Grid.RowDefinitions>
                <RowDefinition></RowDefinition>
                <RowDefinition></RowDefinition>
                <RowDefinition></RowDefinition>
            </Grid.RowDefinitions>
            <Button Grid.Row="0" Margin="3" Command="{Binding TeachULCommand}">
                <Button.Content>
                    <StackPanel>
                        <Label HorizontalContentAlignment="Center">Teach</Label>
                        <Canvas Height="30" Width="50">
                            <Rectangle Height="30" Width="50" Stroke="LightGray" StrokeThickness="2"></Rectangle>
                            <Ellipse Height="4" Width="4" Stroke="Red" Fill="Red" StrokeThickness="2" Canvas.Top="2" Canvas.Left="2"></Ellipse>
                        </Canvas>
                        <Label HorizontalContentAlignment="Center">Upper Left</Label>
                        <StackPanel Orientation="Horizontal">
                            <ContentControl Template="{StaticResource ULPopupControlTemplate}">
                                <Button Margin="3" Content="Move Above" />    
                            </ContentControl>
                            <Button Margin="3" Command="{Binding MoveToULCommand}">Move To
                                <Button.ToolTip>
                                    <StackPanel Orientation="Vertical">
                                        <Label>Currently taught positions:</Label>
                                        <StackPanel Orientation="Horizontal">
                                            <Label>X:</Label>
                                            <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding Path=CurrentULTeachpoint.X, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" />
                                            <Label>Y:</Label>
                                            <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding Path=CurrentULTeachpoint.Y, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" />
                                            <Label>Z:</Label>
                                            <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding Path=CurrentULTeachpoint.Z, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" />
                                            <Label>R:</Label>
                                            <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding Path=CurrentULTeachpoint.R, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" />
                                        </StackPanel>
                                    </StackPanel>
                                </Button.ToolTip>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </Button.Content>
            </Button>
            <Button Grid.Row="1" Margin="3" Command="{Binding TeachLRCommand}">
                <Button.Content>
                    <StackPanel Orientation="Vertical">
                        <Label HorizontalContentAlignment="Center">Teach</Label>
                        <Canvas Height="30" Width="50">
                            <Rectangle Height="30" Width="50" Stroke="LightGray" StrokeThickness="2"></Rectangle>
                            <Ellipse Height="4" Width="4" Stroke="Red" Fill="Red" StrokeThickness="2" Canvas.Top="24" Canvas.Left="44"></Ellipse>
                        </Canvas>
                        <Label HorizontalContentAlignment="Center">Lower Right</Label>
                        <StackPanel Orientation="Horizontal">
                            <ContentControl Template="{StaticResource LRPopupControlTemplate}">
                                <Button Margin="3" Content="Move Above" />
                            </ContentControl>
                            <Button Margin="3" Command="{Binding MoveToLRCommand}">Move To
                                <Button.ToolTip>
                                    <StackPanel Orientation="Vertical">
                                        <Label>Currently taught positions:</Label>
                                        <StackPanel Orientation="Horizontal">
                                            <Label>X:</Label>
                                            <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding Path=CurrentLRTeachpoint.X, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" />
                                            <Label>Y:</Label>
                                            <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding Path=CurrentLRTeachpoint.Y, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" />
                                            <Label>Z:</Label>
                                            <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding Path=CurrentLRTeachpoint.Z, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" />
                                            <Label>R:</Label>
                                            <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding Path=CurrentLRTeachpoint.R, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" />
                                        </StackPanel>
                                    </StackPanel>
                                </Button.ToolTip>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </Button.Content>
            </Button>

            <!-- Wash station teach button -->
            <Grid Grid.Row="2">
                <Grid.RowDefinitions>
                    <RowDefinition></RowDefinition>
                    <RowDefinition></RowDefinition>
                    <RowDefinition></RowDefinition>
                </Grid.RowDefinitions>
                <Button Grid.Row="0" Margin="3" Command="{Binding MoveAboveWashCommand}">Move Above Wash Station</Button>
                <Button Grid.Row="1" Margin="3" Command="{Binding MoveToWashCommand}" Content="Move To Wash Station">
                    <Button.ToolTip>
                        <StackPanel Orientation="Vertical">
                            <Label>Currently taught positions:</Label>
                            <StackPanel Orientation="Horizontal">
                                <Label>X:</Label>
                                <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding Path=CurrentWashTeachpoint.X, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" />
                                <Label>Z:</Label>
                                <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding Path=CurrentWashTeachpoint.Z, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" />
                            </StackPanel>
                        </StackPanel>
                    </Button.ToolTip>
                </Button>
                <Button Grid.Row="2" Margin="3" Command="{Binding TeachWashCommand}">Teach Wash Station</Button>
            </Grid>
        </Grid>
        <!-- robot teaching -->
        <GroupBox Header="Robot Teaching" Grid.ColumnSpan="3" Grid.Row="1">
            <Button Command="{Binding TeachRobotPositionCommand}" Height="25" Margin="3">Teach Robot Position Here</Button>
        </GroupBox>
        <!-- tipbox teaching -->
        <GroupBox Header="TipBox Teaching" Grid.ColumnSpan="3" Grid.Row="2">
            <!-- start tipbox teaching grid -->
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="28" />
                    <RowDefinition Height="28" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="100" />
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <!-- select tipbox -->
                <TextBlock VerticalAlignment="Center" HorizontalAlignment="Right" Grid.Column="0">Select tipbox:</TextBlock>
                <ComboBox Grid.Column="1" ItemsSource="{Binding TipBoxNames}" Text="{Binding SelectedTipBox, Mode=OneWayToSource}" SelectedIndex="0"  Margin="3" MinWidth="200"></ComboBox>
                <Button Grid.Column="2" Command="{Binding TeachTipPositionCommand}" Margin="3" >Teach Tip Position Here</Button>
                <!-- select tip press location -->
                <TextBlock VerticalAlignment="Center" HorizontalAlignment="Right" Grid.Row="1" Grid.Column="0">Select tip:</TextBlock>
                <ComboBox Grid.Row="1" Grid.Column="1" ItemsSource="{Binding TipNames}" Text="{Binding SelectedTip, Mode=OneWayToSource}" SelectedIndex="0"  Margin="3" MinWidth="200"></ComboBox>
                <Button Grid.Row="1" Grid.Column="2" ToolTip="{Binding TestTipOnToolTip}" Command="{Binding TestTipOnCommand}" Margin="3" >Test Tips On</Button>                
            </Grid>
            <!-- end tipbox teaching grid -->
        </GroupBox>
        <!-- position readouts go here -->
        <Grid Grid.ColumnSpan="3" Grid.Row="3" Name="grid_positions">
            <StackPanel Orientation="Horizontal">
                <Label VerticalContentAlignment="Center">X:</Label>
                <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding XPosition, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" Width="80" />
                <Label VerticalContentAlignment="Center">Y:</Label>
                <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding YPosition, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" Width="80" />
                <Label VerticalContentAlignment="Center">Z:</Label>
                <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding ZPosition, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" Width="80" />
                <Label VerticalContentAlignment="Center">W:</Label>
                <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding WPosition, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" Width="80" />
                <Label VerticalContentAlignment="Center">R:</Label>
                <TextBox Background="Black" Foreground="Green" FontWeight="Bold" FontSize="16" TextAlignment="Center" Text="{Binding RPosition, Converter={StaticResource PositionFormatConverter}, ConverterParameter='\{0:0.000\}'}" Width="80" />
            </StackPanel>
        </Grid>
    </Grid>
</UserControl>